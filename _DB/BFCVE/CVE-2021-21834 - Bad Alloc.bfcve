<?xml version="1.0" encoding="utf-8"?>
<CVE Name="CVE-2021-21834">
	<BugWeakness Type="_INP" Class="DVR">
		<Cause Type="The Bug">Missing Code</Cause>
		<Operation Comment="(u64)ptr-&gt;nb_entries &gt; (u64)SIZE_MAX/sizeof(u64)">Verify</Operation>
		<Consequence Comment="&gt; max 64-bit int" Type="Improper Data">Inconsistent Value</Consequence>
		<Attributes>
			<Operand Name="Data">
				<Attribute Type="State">Stored</Attribute>
			</Operand>
			<Operation>
				<Attribute Type="Mechanism">Range</Attribute>
				<Attribute Comment="Library box_code_base.c" Type="Source Code">Third Party</Attribute>
				<Attribute Type="Execution Space">Local</Attribute>
			</Operation>
		</Attributes>
	</BugWeakness>
	<Weakness Type="_DAT" Class="TCM">
		<Cause Type="Improper Data">Wrong Argument</Cause>
		<Operation Comment="ptr-&gt;nb_entries*sizeof(u64)">Calculate</Operation>
		<Consequence Type="Improper Data">Wrap Around</Consequence>
		<Attributes>
			<Operand Name="Data">
				<Attribute Type="Data Kind">Numeric</Attribute>
			</Operand>
			<Operand Name="Type">
				<Attribute Type= "Type Kind">Structure</Attribute>
			</Operand>
			<Operation>
				<Attribute Comment="Arithmetic: ‘*’" Type="Mechanism">Operator</Attribute>
				<Attribute Comment="Library box_code_base.c" Type="Source Code">Third Party</Attribute>
			</Operation>
		</Attributes>
	</Weakness>
	<Weakness Type="_MEM" Class="MAL">
		<Cause Comment="Size of memory to allocate" Type="Improper Data">Wrong Size Used</Cause>
		<Operation Comment="gf_malloc()">Allocate</Operation>
		<Consequence Type="Improper Size">Not Enough Memory Allocated</Consequence>
		<Attributes>
			<Operand Name="Address">
				<Attribute Type="Ownership">Single</Attribute>
				<Attribute Type="Location">Heap</Attribute>
			</Operand>
			<Operation>
				<Attribute Type="Mechanism">Explicit</Attribute>
				<Attribute Comment="Library box_code_base.c" Type="Source Code">Third Party</Attribute>
				<Attribute Type="Execution Space">Userland</Attribute>
			</Operation>
		</Attributes>
	</Weakness>
	<Weakness Type="_MEM" Class="MAD">
		<Cause Type="Improper Size">Not Enough Memory Allocated</Cause>
		<Operation>Reposition</Operation>
		<Consequence Type="Improper Address">Over Bounds Pointer</Consequence>
		<Attributes>
			<Operand Name="Address">
				<Attribute Type="Location">Heap</Attribute>
			</Operand>
			<Operation>
				<Attribute Type="Mechanism">Sequential</Attribute>
				<Attribute Comment="Library box_code_base.c" Type="Source Code">Third Party</Attribute>
			</Operation>
		</Attributes>
	</Weakness>
	<Weakness Type="_MEM" Class="MUS">
		<Cause Type="Improper Address">Over Bounds Pointer</Cause>
		<Operation>Write</Operation>
		<Consequence Type="Memory Error">Buffer Overflow</Consequence>
		<Attributes>
			<Operand Name="Address">
				<Attribute Type="Span">Huge</Attribute>
				<Attribute Type="Location">Heap</Attribute>
			</Operand>
			<Operation>
				<Attribute Type="Mechanism">Sequential</Attribute>
				<Attribute Comment="Library box_code_base.c" Type="Source Code">Third Party</Attribute>
				<Attribute Type="Execution Space">Userland</Attribute>
			</Operation>
		</Attributes>
	</Weakness>
	<WeaknessFailure Type="_FLR" Class="DOS">
		<Cause Type="Memory Error">Buffer Overflow</Cause>
		<Operation>DOS Operation</Operation>
		<Consequence Type="Risk">DOS Conseqeunce</Consequence>
		<Attributes>
			<Operation />
		</Attributes>
	</WeaknessFailure>
</CVE>